<!DOCTYPE html>
<html lang="en">
<head>
  <title>Todo List Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet"
        href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <style>
    .done { text-decoration: line-through; }
  </style>
</head>
<body>
  <div class="container" style="margin-top:1em;">
    <!-- Language selector -->
    <form method="get" style="margin-bottom:1em;">
      Translate to:
      <select name="lang" onchange="this.form.submit()">
        <option value=""  {% if not current_lang %}selected{% endif %}>Original</option>
        <option value="es" {% if current_lang=='es'   %}selected{% endif %}>Spanish</option>
        <option value="fr" {% if current_lang=='fr'   %}selected{% endif %}>French</option>
        <option value="de" {% if current_lang=='de'   %}selected{% endif %}>German</option>
        <option value="zh-cn" {% if current_lang=='zh-cn' %}selected{% endif %}>Chinese</option>
      </select>
    </form>

    <h3>{{ static_labels.heading }}</h3>
    <table class='table'>
      {% for entry in todolist %}
      <tr>
        <td {% if entry.status=='done' %} class='done' {% endif %}>
          {{ entry.what_to_do|safe }}
        </td>
        <td>{{ entry.due_date|safe }}</td>
        <td>
          <button onclick="location.href='/mark/{{ entry.what_to_do|urlencode }}{% if current_lang %}?lang={{ current_lang }}{% endif %}'">
            {{ static_labels.mark_button }}
          </button>
          <button onclick="location.href='/delete/{{ entry.what_to_do|urlencode }}{% if current_lang %}?lang={{ current_lang }}{% endif %}'">
            {{ static_labels.delete_button }}
          </button>
        </td>
      </tr>
      {% else %}
      <tr>
        <td><em>{{ static_labels.empty_message }}</em></td>
      </tr>
      {% endfor %}
    </table>
    <button onclick="toggle_entry_form();" id='toggle_button'>
      {{ static_labels.add_item }}
    </button>
  </div>

  <div class="container">
    <form action="/add" method="POST" id="add-form" style="display:none">
      <input type="hidden" name="lang" value="{{ current_lang }}">
      <div class="row">
        <div class="col-sm-6">
          {{ static_labels.what_label }}
          <input type="text" size="50" name="what_to_do" value="more homework?" />
        </div>
        <div class="col-sm-3">
          {{ static_labels.when_label }}
          <input type="text" name="due_date" value="" />
        </div>
        <div class="col-sm-3">
          <input type="submit" value="{{ static_labels.save_button }}" />
        </div>
      </div>
    </form>
  </div>

  <script>
    var show_entry_form = false;
    // use the translated labels in the toggle
    var txtAdd    = "{{ static_labels.add_item }}";
    var txtCancel = "{{ static_labels.cancel_entry }}";

    function toggle_entry_form() {
      if (show_entry_form) {
        $('#add-form').hide();
        $('#toggle_button').text(txtAdd);
      } else {
        $('#add-form').show();
        $('#toggle_button').text(txtCancel);
      }
      show_entry_form = !show_entry_form;
    };
  </script>
</body>
</html>
